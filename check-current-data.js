const { Pool } = require('pg');

const pool = new Pool({
  connectionString: 'postgresql://postgres:PddzJpAQYezqknsntSzmCUlQYuYJldcT@crossover.proxy.rlwy.net:44255/railway',
  ssl: { rejectUnauthorized: false }
});

// المنصات المطلوبة - 95 منصة فقط
const requiredPlatforms = [
  'مطعم الوجبات الجاهزة',
  'مطعم للوجبات السريعة',
  'كافيهات',
  'عربات بيع الطعام',
  'مطعم فاخر',
  'مخبز',
  'متجر كيك',
  'متجر حلويات',
  'توزيع الأطعمة',
  'موزّع مشروبات',
  'متجر بقالة',
  'متجر كتب',
  'متجر ملابس',
  'متجر مستحضرات التجميل',
  'متجر إلكترونيات',
  'متجر أثاث',
  'متجر معدات',
  'متجر ألعاب',
  'متجر مستلزمات زراعية',
  'قطع غيار المركبات',
  'متجر الحرف اليدوية',
  'محل دراجات',
  'متجر نظارات',
  'متجر معدات تقنية المعلومات والدعم',
  'الشحن والتوصيل',
  'خدمات التنظيف',
  'كهربائي',
  'العناية بالحدائق',
  'خدمات الصيانة',
  'خدمات صناعة الأحذية',
  'المسح والتخطيط',
  'نجّار',
  'أنظمة الطاقة الشمسية',
  'خدمات التكييف',
  'منسق أزهار',
  'تأجير دراجات',
  'الخدمات اللوجستية من طرف ثالث',
  'ورش عمل مدرسة لتعليم القيادة',
  'التعلم الإلكتروني',
  'منظمة طلابية',
  'المخيمات الصيفية',
  'ممارس صحي',
  'صيدلية',
  'عيادة بيطرية',
  'صالون تصفيف الشعر',
  'محل وشوم',
  'ممرات البولينج',
  'النادي الرياضي للتسلق',
  'مركز لياقة بدنية',
  'مدرب شخصي',
  'الفعاليات الرياضية',
  'نادي رياضي',
  'نادي الرياضات الجماعية',
  'قاعات الحفلات الموسيقية',
  'صالة عرض',
  'صالة افراح',
  'المكتبة',
  'متحف',
  'تصوير',
  'السينما',
  'نادي',
  'إدارة الفعاليات',
  'صالات الأفراح والمناسبات',
  'متعهد حفلات الزفاف',
  'غرف الألغاز',
  'الملاهي الليلية',
  'العقارات',
  'اتحاد مُلاّك العقارات',
  'البناء',
  'تأجير شقق مفروشة',
  'منزل عطلات',
  'فندق',
  'نزل للضيوف',
  'موقع التخييم',
  'خيام وبيوت جاهزة',
  'كرفنات',
  'جولات بصحبة مُرشد سياحي',
  'منتجع صحي',
  'هدايا الشركات',
  'تصنيع الأثاث حسب الطلب',
  'مُصنِّع معادن',
  'تصنيع الأقمشة والمنسوجات',
  'شركة هندسة معمارية',
  'بيئية',
  'استقطاب المواهب',
  'منشأة قانونية',
  'وكالة تسويقية',
  'شريك نايوش',
  'بائع وسيط للبرمجيات',
  'محاسبة',
  'تحصيل',
  'التدقيق والتوثيق',
  'منظمة غير ربحية',
  'تأجير لوحات إعلانية',
  'تجارة الوقود'
];

// الحاضنات المطلوبة - 100 حاضنة فقط
const requiredIncubators = [
  'التعليم والتعلم',
  'التدريب والشهادات الإحترافية',
  'التسويق الرقمي',
  'نادي بيتا الرقمي',
  'الإعتمادات الدولية',
  'الإعتمادات المحلية',
  'الحياة الرقمية',
  'المنضمات والجمعيات المحلية',
  'المنضمات والجمعيات الدولية',
  'المدن الصناعية',
  'الشعر والأدب',
  'الغرف الصناعية',
  'العرف التجارية',
  'النقابات',
  'الإيتيكيت',
  'عالم الأعمال',
  'الرياضة واللياقة',
  'الطعام والشراب',
  'المطابخ السحابية',
  'المطابخ والولائم',
  'مطاعم متنقلة',
  'شقق مفروشة',
  'الفنادق',
  'المجمعات السنكية',
  'شليهات',
  'نوادي رياضية',
  'نوادي ليلية',
  'السياحة والترفيه',
  'المرافق',
  'المولات ومجمعات التسوق',
  'الكافيهات',
  'الترفيه',
  'التصميم الداخلي',
  'تصميم جرافيك',
  'الإنشاءات',
  'الديكورات',
  'مواد البناء',
  'مواد الديكو',
  'مقاولات عامة',
  'طاقة',
  'الصحة والجمال',
  'فريلانسر استشارات زتدريب',
  'المبادرات',
  'رعاية الحيوانات وتربيتها',
  'خدمة العملاء',
  'الموارد البشرية',
  'المالية والمحاسبة والضريبة',
  'التحصيل',
  'الرعاية الصحية',
  'صيدليات',
  'التغذية والجيم',
  'القانونية والإستشارات',
  'الإستشارات والبحوث',
  'الإستشارات النفسية',
  'الإستشارات الطبية والعيادات',
  'الصناعات والمدن الصناعية',
  'الجودة الشاملة والأيزو',
  'السلامة والصحة المهنية',
  'الأمن الصناعي والغذائي',
  'الحراسات الأمنية',
  'معارض السيارات',
  'معارض المعدات',
  'معارض الأدوات',
  'مستلزمات المنزل',
  'النقل',
  'التوصيل',
  'الخدمات اللوجستية',
  'الخضروات والفاكهة',
  'العطارة',
  'أثاث وأجهزة منزلية ومكتبية',
  'الحلويات والعصائر',
  'محامص ومكسرات',
  'الورد والزينة',
  'الملابس والأحذية',
  'الأعراس والحفلات',
  'مغاسل السيارات',
  'مكتانيكا وكهرباء سيارات',
  'كمبيوترات وصيانة',
  'تحف و إكسسوارات',
  'مجوهرات',
  'تصفيات',
  'كل شي مستعمل',
  'عيادات ومراكز طبية',
  'عيادات بيطرية',
  'اعلاف واغذية للحيوانات',
  'سجاد وموكيت',
  'سلاسل الإمداد',
  'محطات وقود وغسيل سيارات',
  'جامعات ومعاهد ومراكز',
  'تجهيزات كطابخ صناعية',
  'أجهزة وملابس رياضية',
  'معاصر زيتون',
  'موزعي مواد غذائية',
  'مطابع ومستلزماتها',
  'إكسسوارات ةزينة سيارات',
  'قرطاسية واوازم مدرسية',
  'مدارس خاصة',
  'جوالات وإكسسواراتها',
  'اتصالات',
  'خردوات وكل شي مستعمل'
];

async function checkCurrentData() {
  try {
    console.log('=== فحص المنصات الحالية ===\n');
    
    const platformsResult = await pool.query('SELECT id, name FROM platforms ORDER BY name');
    const currentPlatforms = platformsResult.rows.map(r => r.name);
    
    console.log(`عدد المنصات الحالية: ${currentPlatforms.length}`);
    console.log(`عدد المنصات المطلوبة: ${requiredPlatforms.length}\n`);
    
    // المنصات الزائدة
    const extraPlatforms = currentPlatforms.filter(p => !requiredPlatforms.includes(p));
    if (extraPlatforms.length > 0) {
      console.log(`⚠️ منصات زائدة (${extraPlatforms.length}):`);
      extraPlatforms.forEach(p => console.log(`  - ${p}`));
      console.log();
    }
    
    // المنصات الناقصة
    const missingPlatforms = requiredPlatforms.filter(p => !currentPlatforms.includes(p));
    if (missingPlatforms.length > 0) {
      console.log(`⚠️ منصات ناقصة (${missingPlatforms.length}):`);
      missingPlatforms.forEach(p => console.log(`  - ${p}`));
      console.log();
    }
    
    if (extraPlatforms.length === 0 && missingPlatforms.length === 0) {
      console.log('✅ جميع المنصات صحيحة - 95 منصة\n');
    }
    
    console.log('\n=== فحص الحاضنات الحالية ===\n');
    
    const incubatorsResult = await pool.query('SELECT id, name FROM incubators ORDER BY name');
    const currentIncubators = incubatorsResult.rows.map(r => r.name);
    
    console.log(`عدد الحاضنات الحالية: ${currentIncubators.length}`);
    console.log(`عدد الحاضنات المطلوبة: ${requiredIncubators.length}\n`);
    
    // الحاضنات الزائدة
    const extraIncubators = currentIncubators.filter(i => !requiredIncubators.includes(i));
    if (extraIncubators.length > 0) {
      console.log(`⚠️ حاضنات زائدة (${extraIncubators.length}):`);
      extraIncubators.forEach(i => console.log(`  - ${i}`));
      console.log();
    }
    
    // الحاضنات الناقصة
    const missingIncubators = requiredIncubators.filter(i => !currentIncubators.includes(i));
    if (missingIncubators.length > 0) {
      console.log(`⚠️ حاضنات ناقصة (${missingIncubators.length}):`);
      missingIncubators.forEach(i => console.log(`  - ${i}`));
      console.log();
    }
    
    if (extraIncubators.length === 0 && missingIncubators.length === 0) {
      console.log('✅ جميع الحاضنات صحيحة - 100 حاضنة\n');
    }
    
    await pool.end();
  } catch (err) {
    console.error('خطأ:', err);
    await pool.end();
  }
}

checkCurrentData();
