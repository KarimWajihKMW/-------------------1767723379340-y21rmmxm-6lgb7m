-- =====================================================
-- ุฅุถุงูุฉ ุงูุฃุฏูุงุฑ ุงูู 33 ุงูุฌุฏูุฏุฉ ููุธุงู ูุงููุด
-- =====================================================

-- ุญุฐู ุงูุชูุฑุงุฑุงุช (ุฅู ูุฌุฏุช)
DELETE FROM roles 
WHERE id NOT IN (
  SELECT MIN(id) 
  FROM roles 
  GROUP BY name
);

-- ุฅุถุงูุฉ ุงูุฃุฏูุงุฑ ุงูุฌุฏูุฏุฉ (ุชุญุฏูุซ ุฅุฐุง ูุงูุช ููุฌูุฏุฉ)
-- ูุชู ุงุณุชุฎุฏุงู ON CONFLICT ูุชุฌูุจ ุงูุฃุฎุทุงุก ุนูุฏ ุงูุชูุฑุงุฑ

INSERT INTO roles (name, name_ar, description, level, is_system) VALUES
-- 1. ุณูุจุฑ ุขุฏูู (ููุฌูุฏ - ุณูุชู ุชุญุฏูุซู)
('SUPER_ADMIN', 'ุณูุจุฑ ุขุฏูู', 'ุตูุงุญูุงุช ูุงููุฉ ุนูู ุฌููุน ูุณุชููุงุช ุงููุธุงู', 'HQ', true),

-- 2. ูุฏูุฑ ุจุฑูุฌูุงุช ูุชูููููุฌูุง ุงููุนูููุงุช
('IT_MANAGER', 'ูุฏูุฑ ุจุฑูุฌูุงุช ูุชูููููุฌูุง ุงููุนูููุงุช', 'ูุณุคูู ุนู ุงูุจููุฉ ุงูุชุญุชูุฉ ุงูุชูููุฉ ูุงูุจุฑูุฌูุงุช', 'HQ', false),

-- 3. ูุฏูุฑ ุชูููุฐู - ุงูููุชุจ ุงูุฑุฆูุณู
('HQ_EXECUTIVE_MANAGER', 'ูุฏูุฑ ุชูููุฐู - ุงูููุชุจ ุงูุฑุฆูุณู', 'ูุฏูุฑ ุชูููุฐู ูู ุงูููุชุจ ุงูุฑุฆูุณู', 'HQ', false),

-- 4. ูุฏูุฑ ูุงูู - ุงูููุชุจ ุงูุฑุฆูุณู
('HQ_FINANCIAL_MANAGER', 'ูุฏูุฑ ูุงูู - ุงูููุชุจ ุงูุฑุฆูุณู', 'ูุณุคูู ุนู ุงูุดุคูู ุงููุงููุฉ ูู ุงูููุชุจ ุงูุฑุฆูุณู', 'HQ', false),

-- 5. ูุฏูุฑ ุชุณููู - ุงูููุชุจ ุงูุฑุฆูุณู
('HQ_MARKETING_MANAGER', 'ูุฏูุฑ ุชุณููู - ุงูููุชุจ ุงูุฑุฆูุณู', 'ูุณุคูู ุนู ุงูุชุณููู ูู ุงูููุชุจ ุงูุฑุฆูุณู', 'HQ', false),

-- 6. ูุฏูุฑ ูุดุชุฑูุงุช - ุงูููุชุจ ุงูุฑุฆูุณู
('HQ_PROCUREMENT_MANAGER', 'ูุฏูุฑ ูุดุชุฑูุงุช - ุงูููุชุจ ุงูุฑุฆูุณู', 'ูุณุคูู ุนู ุงููุดุชุฑูุงุช ูู ุงูููุชุจ ุงูุฑุฆูุณู', 'HQ', false),

-- 7. ูุฏูุฑ ุนูุงูุงุช ุนุงูุฉ - ุงูููุชุจ ุงูุฑุฆูุณู
('HQ_PR_MANAGER', 'ูุฏูุฑ ุนูุงูุงุช ุนุงูุฉ - ุงูููุชุจ ุงูุฑุฆูุณู', 'ูุณุคูู ุนู ุงูุนูุงูุงุช ุงูุนุงูุฉ ูู ุงูููุชุจ ุงูุฑุฆูุณู', 'HQ', false),

-- 8. ูุฏูุฑ ุงููุงููููุฉ ูุงูุงุณุชุดุงุฑุงุช
('LEGAL_MANAGER', 'ูุฏูุฑ ุงููุงููููุฉ ูุงูุงุณุชุดุงุฑุงุช', 'ูุณุคูู ุนู ุงูุดุคูู ุงููุงููููุฉ ูุงูุงุณุชุดุงุฑุงุช', 'HQ', false),

-- 9. ูุฏูุฑ ุชุญุฑูุฑ ูุญุชูู ูููุงูุงุช
('CONTENT_MANAGER', 'ูุฏูุฑ ุชุญุฑูุฑ ูุญุชูู ูููุงูุงุช', 'ูุณุคูู ุนู ุชุญุฑูุฑ ุงููุญุชูู ูุงูููุงูุงุช', 'HQ', false),

-- 10. ูุฏูุฑ ุงููุจุงุฏุฑุงุช
('INITIATIVES_MANAGER', 'ูุฏูุฑ ุงููุจุงุฏุฑุงุช', 'ูุณุคูู ุนู ุฅุฏุงุฑุฉ ุงููุจุงุฏุฑุงุช', 'HQ', false),

-- 11. ูุฏูุฑ ูุฑููุงูุณุฑ
('FREELANCER_MANAGER', 'ูุฏูุฑ ูุฑููุงูุณุฑ', 'ูุณุคูู ุนู ุฅุฏุงุฑุฉ ุงููุณุชูููู', 'HQ', false),

-- 12. ุฅุฏุงุฑู ุชูููุฐู ูุตูู
('EXECUTIVE_DESIGNER', 'ุฅุฏุงุฑู ุชูููุฐู ูุตูู', 'ุฅุฏุงุฑู ุชูููุฐู ูุชุฎุตุต ูู ุงูุชุตููู', 'HQ', false),

-- 13. ุฅุฏุงุฑู ุชูููุฐู ูุณูู
('EXECUTIVE_MARKETER', 'ุฅุฏุงุฑู ุชูููุฐู ูุณูู', 'ุฅุฏุงุฑู ุชูููุฐู ูุชุฎุตุต ูู ุงูุชุณููู', 'HQ', false),

-- 14. ุฅุฏุงุฑู ุชูููุฐู ูุจูุนุงุช
('EXECUTIVE_SALES', 'ุฅุฏุงุฑู ุชูููุฐู ูุจูุนุงุช', 'ุฅุฏุงุฑู ุชูููุฐู ูุชุฎุตุต ูู ุงููุจูุนุงุช', 'HQ', false),

-- 15. ุฅุฏุงุฑู ุชูููุฐู ููู ุณูุชุฑ
('EXECUTIVE_CALLCENTER', 'ุฅุฏุงุฑู ุชูููุฐู ููู ุณูุชุฑ', 'ุฅุฏุงุฑู ุชูููุฐู ูุชุฎุตุต ูู ูุฑูุฒ ุงูุงุชุตุงูุงุช', 'HQ', false),

-- 16. ุฅุฏุงุฑู ุชูููุฐู ููุตุงุช ุงูุชูุงุตู
('EXECUTIVE_SOCIAL_MEDIA', 'ุฅุฏุงุฑู ุชูููุฐู ููุตุงุช ุงูุชูุงุตู', 'ุฅุฏุงุฑู ุชูููุฐู ูุชุฎุตุต ูู ููุตุงุช ุงูุชูุงุตู ุงูุงุฌุชูุงุนู', 'HQ', false),

-- 17. ูุญุฑุฑ
('EDITOR', 'ูุญุฑุฑ', 'ูุญุฑุฑ ูุญุชูู ูููุงูุงุช', 'HQ', false),

-- 18. ูุฏูุฑ ูุฑุน (ููุฌูุฏ - ุณูุชู ุชุญุฏูุซู)
('BRANCH_MANAGER', 'ูุฏูุฑ ูุฑุน', 'ูุณุคูู ุนู ุฅุฏุงุฑุฉ ุงููุฑุน', 'BRANCH', false),

-- 19. ูุณุงุนุฏ ูุฏูุฑ ูุฑุน
('ASSISTANT_BRANCH_MANAGER', 'ูุณุงุนุฏ ูุฏูุฑ ูุฑุน', 'ูุณุงุนุฏ ูุฏูุฑ ุงููุฑุน', 'BRANCH', false),

-- 20. ุฅุฏุงุฑู ูุฑุน
('BRANCH_ADMIN', 'ุฅุฏุงุฑู ูุฑุน', 'ุฅุฏุงุฑู ูู ุงููุฑุน', 'BRANCH', false),

-- 21. ูุฏูุฑ ุญุงุถูุฉ (ููุฌูุฏ - ุณูุชู ุชุญุฏูุซู)
('INCUBATOR_MANAGER', 'ูุฏูุฑ ุญุงุถูุฉ', 'ูุณุคูู ุนู ุฅุฏุงุฑุฉ ุงูุญุงุถูุฉ', 'INCUBATOR', false),

-- 22. ูุณุงุนุฏ ูุฏูุฑ ุญุงุถูุฉ
('ASSISTANT_INCUBATOR_MANAGER', 'ูุณุงุนุฏ ูุฏูุฑ ุญุงุถูุฉ', 'ูุณุงุนุฏ ูุฏูุฑ ุงูุญุงุถูุฉ', 'INCUBATOR', false),

-- 23. ุฅุฏุงุฑู ุญุงุถูุฉ
('INCUBATOR_ADMIN', 'ุฅุฏุงุฑู ุญุงุถูุฉ', 'ุฅุฏุงุฑู ูู ุงูุญุงุถูุฉ', 'INCUBATOR', false),

-- 24. ูุฏูุฑ ููุตุฉ (ููุฌูุฏ - ุณูุชู ุชุญุฏูุซู)
('PLATFORM_MANAGER', 'ูุฏูุฑ ููุตุฉ', 'ูุณุคูู ุนู ุฅุฏุงุฑุฉ ุงูููุตุฉ', 'PLATFORM', false),

-- 25. ูุณุงุนุฏ ูุฏูุฑ ููุตุฉ
('ASSISTANT_PLATFORM_MANAGER', 'ูุณุงุนุฏ ูุฏูุฑ ููุตุฉ', 'ูุณุงุนุฏ ูุฏูุฑ ุงูููุตุฉ', 'PLATFORM', false),

-- 26. ุฅุฏุงุฑู ููุตุฉ
('PLATFORM_ADMIN', 'ุฅุฏุงุฑู ููุตุฉ', 'ุฅุฏุงุฑู ูู ุงูููุตุฉ', 'PLATFORM', false),

-- 27. ูุณุคูู ุชูููุฐู ููุงุชุจ
('OFFICE_EXECUTIVE', 'ูุณุคูู ุชูููุฐู ููุงุชุจ', 'ูุณุคูู ุชูููุฐู ููููุงุชุจ', 'OFFICE', false),

-- 28. ุฅุฏุงุฑู ุชูููุฐู ููุงุชุจ
('OFFICE_ADMIN', 'ุฅุฏุงุฑู ุชูููุฐู ููุงุชุจ', 'ุฅุฏุงุฑู ุชูููุฐู ูู ุงูููุงุชุจ', 'OFFICE', false),

-- 29. ููุธู ููุฌุณุชูุงุช
('LOGISTICS_EMPLOYEE', 'ููุธู ููุฌุณุชูุงุช', 'ููุธู ูุชุฎุตุต ูู ุงูููุฌุณุชูุงุช', 'ALL', false),

-- 30. ูุฏุฑุจ ุฏุงุฆู
('PERMANENT_TRAINER', 'ูุฏุฑุจ ุฏุงุฆู', 'ูุฏุฑุจ ุฏุงุฆู ูู ุงููุธุงู', 'ALL', false),

-- 31. ูุฏุฑุจ ูุฑููุงูุณุฑ
('FREELANCER_TRAINER', 'ูุฏุฑุจ ูุฑููุงูุณุฑ', 'ูุฏุฑุจ ูุณุชูู', 'ALL', false),

-- 32. ูุฏุฑุจ ูุชุทูุน
('VOLUNTEER_TRAINER', 'ูุฏุฑุจ ูุชุทูุน', 'ูุฏุฑุจ ูุชุทูุน', 'ALL', false),

-- 33. ูุชุทูุน ูุจุงุฏุฑุงุช
('INITIATIVES_VOLUNTEER', 'ูุชุทูุน ูุจุงุฏุฑุงุช', 'ูุชุทูุน ูู ุงููุจุงุฏุฑุงุช', 'ALL', false)

ON CONFLICT (name) 
DO UPDATE SET 
  name_ar = EXCLUDED.name_ar,
  description = EXCLUDED.description,
  level = EXCLUDED.level,
  updated_at = CURRENT_TIMESTAMP;

-- ุชุญุฏูุซ timestamp
UPDATE roles SET updated_at = CURRENT_TIMESTAMP WHERE updated_at IS NULL;

-- =====================================================
-- ุงูุชุญูู ูู ุงููุชุงุฆุฌ
-- =====================================================
DO $$
DECLARE
    role_count INTEGER;
BEGIN
    SELECT COUNT(*) INTO role_count FROM roles;
    RAISE NOTICE 'โ ุชู ุฅุถุงูุฉ/ุชุญุฏูุซ ุงูุฃุฏูุงุฑ ุจูุฌุงุญ';
    RAISE NOTICE '๐ ุฅุฌูุงูู ุนุฏุฏ ุงูุฃุฏูุงุฑ: %', role_count;
END $$;
